<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Animated Plymouth Rock Chicken</title>
    <style>
        body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: transparent;
            overflow: hidden;
        }
        #container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }
        #chicken {
            width: 500px;
            height: 500px;
            position: absolute;
            transition: transform 0.3s ease;
        }
        #startButton {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <button id="startButton">Start Audio</button>
    <div id="container">
        <svg id="chicken" viewBox="0 0 800 800" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <!-- Natural feather texture -->
                <pattern id="featherTexture" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse">
                    <rect width="20" height="20" fill="#E8E8E8"/>
                    <path d="M0 10 C5 5, 15 5, 20 10 C15 15, 5 15, 0 10" fill="#D0D0D0" opacity="0.5"/>
                    <path d="M10 0 C15 5, 15 15, 10 20 C5 15, 5 5, 10 0" fill="#D0D0D0" opacity="0.5"/>
                </pattern>

                <!-- Feather highlight gradient -->
                <linearGradient id="featherHighlight" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" style="stop-color:#FFFFFF;stop-opacity:0.2"/>
                    <stop offset="50%" style="stop-color:#D8D8D8;stop-opacity:0.1"/>
                    <stop offset="100%" style="stop-color:#A0A0A0;stop-opacity:0.2"/>
                </linearGradient>

                <!-- Skin texture for comb and wattle -->
                <linearGradient id="skinTexture" x1="0%" y1="0%" x2="100%" y2="0%">
                    <stop offset="0%" style="stop-color:#FF0000"/>
                    <stop offset="50%" style="stop-color:#FF2200"/>
                    <stop offset="100%" style="stop-color:#FF0000"/>
                </linearGradient>
            </defs>

            <!-- Neck and body area -->
            <path d="M300 250 
                     C400 230, 500 250, 600 300
                     C650 350, 650 450, 600 500
                     C500 550, 300 550, 200 500
                     C150 450, 150 350, 200 300
                     C250 250, 250 250, 300 250" 
                  fill="url(#featherTexture)"/>
            
            <!-- Layered feather details -->
            <g id="featherDetails">
                <path d="M250 350 C300 330, 400 330, 450 350" stroke="#404040" stroke-width="1" fill="none" opacity="0.6"/>
                <path d="M240 370 C300 350, 400 350, 460 370" stroke="#404040" stroke-width="1" fill="none" opacity="0.6"/>
                <path d="M230 390 C300 370, 400 370, 470 390" stroke="#404040" stroke-width="1" fill="none" opacity="0.6"/>
                <path d="M220 410 C300 390, 400 390, 480 410" stroke="#404040" stroke-width="1" fill="none" opacity="0.6"/>
            </g>

            <!-- Head structure -->
            <g id="head">
                <!-- Base head shape -->
                <path d="M260 100
                         C290 80, 330 80, 360 100
                         C380 120, 380 160, 360 180
                         C330 200, 290 200, 260 180
                         C240 160, 240 120, 260 100" 
                      fill="url(#featherTexture)"/>

                <!-- Realistic eye -->
                <g id="eye">
                    <!-- Eye socket shading -->
                    <path d="M280 135 C290 125, 310 125, 320 135 C310 145, 290 145, 280 135" 
                          fill="#2A2A2A" opacity="0.3"/>
                    <!-- White of eye -->
                    <ellipse cx="300" cy="135" rx="12" ry="14" fill="#FFFFFF"/>
                    <!-- Iris -->
                    <ellipse cx="300" cy="135" rx="8" ry="10" fill="#4B3621"/>
                    <!-- Pupil -->
                    <ellipse cx="300" cy="135" rx="4" ry="5" fill="#000000"/>
                    <!-- Eye highlight -->
                    <circle cx="296" cy="131" r="3" fill="#FFFFFF"/>
                </g>

                <!-- Comb detail -->
                <path d="M300 70
                         Q315 40, 330 70
                         Q345 30, 360 70
                         Q375 40, 390 70" 
                      fill="url(#skinTexture)" 
                      stroke="#CC0000" 
                      stroke-width="1"/>

                <!-- Wattle -->
                <path d="M275 180
                         Q295 210, 315 180" 
                      fill="url(#skinTexture)" 
                      stroke="#CC0000" 
                      stroke-width="1"/>

                <!-- Split beak -->
                <g id="beak">
                    <!-- Upper beak -->
                    <path id="upperBeak" 
                          d="M260 140 L210 135 L260 140" 
                          fill="#D2B48C" 
                          stroke="#8B4513" 
                          stroke-width="1"/>
                    
                    <!-- Lower beak -->
                    <path id="lowerBeak" 
                          d="M260 140 L210 145 L260 140" 
                          fill="#C1A27C" 
                          stroke="#8B4513" 
                          stroke-width="1"/>
                </g>
            </g>

            <!-- Legs -->
            <g id="legs">
                <!-- Left leg -->
                <path d="M350 500 L350 600" 
                      stroke="#E8C098" 
                      stroke-width="8" 
                      stroke-linecap="round"/>
                <!-- Left foot -->
                <path d="M350 600 L340 610 M350 600 L350 610 M350 600 L360 610" 
                      stroke="#E8C098" 
                      stroke-width="6" 
                      stroke-linecap="round"/>

                <!-- Right leg -->
                <path d="M450 500 L450 600" 
                      stroke="#E8C098" 
                      stroke-width="8" 
                      stroke-linecap="round"/>
                <!-- Right foot -->
                <path d="M450 600 L440 610 M450 600 L450 610 M450 600 L460 610" 
                      stroke="#E8C098" 
                      stroke-width="6" 
                      stroke-linecap="round"/>
            </g>

            <!-- Tail feathers -->
            <g id="tail">
                <path d="M600 350 Q650 300, 620 400" 
                      fill="url(#featherTexture)"/>
                <path d="M610 340 Q660 290, 630 390" 
                      fill="url(#featherTexture)"/>
                <path d="M620 330 Q670 280, 640 380" 
                      fill="url(#featherTexture)"/>
            </g>
        </svg>
    </div>
   <script>
        let audioContext;
        let analyser;
        let dataArray;
        const chicken = document.getElementById('chicken');
        const container = document.getElementById('container');
        const upperBeak = document.getElementById('upperBeak');
        const lowerBeak = document.getElementById('lowerBeak');
        const head = document.getElementById('head');
        let isAudioInitialized = false;
        let currentBehavior = 'idle';
        let behaviorTime = 0;
        
        // Center chicken initially
        chicken.style.left = `${window.innerWidth/2 - 250}px`;
        chicken.style.top = `${window.innerHeight/2 - 250}px`;

        // Behaviors and their durations
        const behaviors = {
            idle: { duration: 2000, next: ['lookLeft', 'lookRight', 'walkLeft', 'walkRight', 'peck'] },
            lookLeft: { duration: 1500, next: ['idle', 'walkLeft', 'peck'] },
            lookRight: { duration: 1500, next: ['idle', 'walkRight', 'peck'] },
            walkLeft: { duration: 3000, next: ['idle', 'lookLeft', 'peck'] },
            walkRight: { duration: 3000, next: ['idle', 'lookRight', 'peck'] },
            peck: { duration: 1000, next: ['idle', 'walkLeft', 'walkRight'] }
        };

        document.getElementById('startButton').addEventListener('click', async () => {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                analyser = audioContext.createAnalyser();
                analyser.fftSize = 1024;
                
                const source = audioContext.createMediaStreamSource(stream);
                source.connect(analyser);
                dataArray = new Uint8Array(analyser.frequencyBinCount);
                isAudioInitialized = true;
                
                animate();
                updateBehavior();
                
            } catch (err) {
                console.error('Error accessing microphone:', err);
                alert('Please ensure microphone access is allowed and try again.');
            }
        });

        function updateBehavior() {
            const possibleNext = behaviors[currentBehavior].next;
            currentBehavior = possibleNext[Math.floor(Math.random() * possibleNext.length)];
            behaviorTime = 0;
            
            setTimeout(updateBehavior, behaviors[currentBehavior].duration);
        }

        function performBehavior(volume) {
            behaviorTime += 16.67; // Approximate time between frames
            const progress = behaviorTime / behaviors[currentBehavior].duration;
            
            const currentLeft = parseInt(chicken.style.left);
            const currentTop = parseInt(chicken.style.top);
            let headRotation = 0;
            let headY = 0;

            switch(currentBehavior) {
                case 'lookLeft':
                    headRotation = -20 * Math.sin(Math.PI * progress);
                    break;
                    
                case 'lookRight':
                    headRotation = 20 * Math.sin(Math.PI * progress);
                    break;
                    
                case 'walkLeft':
                    chicken.style.transform = 'scaleX(-1)';
                    const newLeftPos = currentLeft - 1;
                    if (newLeftPos > 0) {
                        chicken.style.left = `${newLeftPos}px`;
                    }
                    headRotation = 5 * Math.sin(progress * Math.PI * 4);
                    break;
                    
                case 'walkRight':
                    chicken.style.transform = 'scaleX(1)';
                    const newRightPos = currentLeft + 1;
                    if (newRightPos < window.innerWidth - 500) {
                        chicken.style.left = `${newRightPos}px`;
                    }
                    headRotation = 5 * Math.sin(progress * Math.PI * 4);
                    break;
                    
                case 'peck':
                    headRotation = 30 * Math.sin(Math.PI * progress);
                    headY = 20 * Math.sin(Math.PI * progress);
                    // Beak movement during pecking
                    if (progress > 0.4 && progress < 0.6) {
                        upperBeak.setAttribute('d', `M260 140 L210 ${130} L260 140`);
                        lowerBeak.setAttribute('d', `M260 140 L210 ${150} L260 140`);
                    } else {
                        upperBeak.setAttribute('d', 'M260 140 L210 135 L260 140');
                        lowerBeak.setAttribute('d', 'M260 140 L210 145 L260 140');
                    }
                    break;
            }

            // Apply head movements
            head.style.transform = `rotate(${headRotation}deg) translateY(${headY}px)`;
        }

        function animate() {
            if (!isAudioInitialized) return;
            
            analyser.getByteFrequencyData(dataArray);
            const volume = dataArray.slice(10, 50).reduce((a, b) => a + b) / 40;
            
            // Handle audio-based beak movement
            if (volume > 30 && currentBehavior !== 'peck') {
                const beakOpen = Math.min(volume / 40, 10);
                upperBeak.setAttribute('d', `M260 140 L210 ${135 - beakOpen} L260 140`);
                lowerBeak.setAttribute('d', `M260 140 L210 ${145 + beakOpen} L260 140`);
            }
            
            // Perform current behavior
            performBehavior(volume);
            
            requestAnimationFrame(animate);
        }

        // Handle window resize
        window.addEventListener('resize', () => {
            const chickenLeft = parseInt(chicken.style.left);
            const chickenTop = parseInt(chicken.style.top);
            
            chicken.style.left = `${Math.min(chickenLeft, window.innerWidth - 500)}px`;
            chicken.style.top = `${Math.min(chickenTop, window.innerHeight - 500)}px`;
        });
    </script>
</body>
</html>

[Previous SVG content remains exactly the same until the script section]

    <script>
        let audioContext;
        let analyser;
        let dataArray;
        const chicken = document.getElementById('chicken');
        const container = document.getElementById('container');
        const upperBeak = document.getElementById('upperBeak');
        const lowerBeak = document.getElementById('lowerBeak');
        let isAudioInitialized = false;

        // Center chicken initially
        chicken.style.left = `${window.innerWidth/2 - 250}px`;
        chicken.style.top = `${window.innerHeight/2 - 250}px`;

        document.getElementById('startButton').addEventListener('click', async () => {
            try {
                // First request microphone permission
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                
                // Then initialize audio context
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                analyser = audioContext.createAnalyser();
                analyser.fftSize = 1024;
                
                const source = audioContext.createMediaStreamSource(stream);
                source.connect(analyser);
                dataArray = new Uint8Array(analyser.frequencyBinCount);
                isAudioInitialized = true;
                
                // Start animation
                animate();
                
                // Occasional subtle movement
                setInterval(subtleMove, 5000); // Every 5 seconds
                
            } catch (err) {
                console.error('Error accessing microphone:', err);
                alert('Please ensure microphone access is allowed and try again.');
            }
        });

        function subtleMove() {
            // Only small random movements
            const smallMove = 20; // pixels
            const currentLeft = parseInt(chicken.style.left);
            const currentTop = parseInt(chicken.style.top);
            
            const newX = currentLeft + (Math.random() * smallMove - smallMove/2);
            const newY = currentTop + (Math.random() * smallMove - smallMove/2);
            
            // Ensure chicken stays within bounds
            chicken.style.left = `${Math.max(0, Math.min(window.innerWidth - 500, newX))}px`;
            chicken.style.top = `${Math.max(0, Math.min(window.innerHeight - 500, newY))}px`;
        }

        function animate() {
            if (!isAudioInitialized) return;
            
            analyser.getByteFrequencyData(dataArray);
            
            // Calculate volume focusing on speech frequencies
            const volume = dataArray.slice(10, 50).reduce((a, b) => a + b) / 40;
            
            // Beak animation only happens with significant sound
            if (volume > 30) {
                const beakOpen = Math.min(volume / 40, 10);
                upperBeak.setAttribute('d', `M260 140 L210 ${135 - beakOpen} L260 140`);
                lowerBeak.setAttribute('d', `M260 140 L210 ${145 + beakOpen} L260 140`);
            } else {
                // Close beak when quiet
                upperBeak.setAttribute('d', 'M260 140 L210 135 L260 140');
                lowerBeak.setAttribute('d', 'M260 140 L210 145 L260 140');
            }
            
            requestAnimationFrame(animate);
        }

        // Handle window resize
        window.addEventListener('resize', () => {
            const chickenLeft = parseInt(chicken.style.left);
            const chickenTop = parseInt(chicken.style.top);
            
            chicken.style.left = `${Math.min(chickenLeft, window.innerWidth - 500)}px`;
            chicken.style.top = `${Math.min(chickenTop, window.innerHeight - 500)}px`;
        });
    </script>
</body>
</html>
